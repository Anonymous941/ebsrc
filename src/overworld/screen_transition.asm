
SCREEN_TRANSITION: ;$C06662
	.DEFINE ANIM_SPEED $02
    .DEFINE ANIMATION_ENTRY_POSITION $04
    .DEFINE ANIM_PTR_LO $06
    .DEFINE ANIM_PTR_HI $08
    .DEFINE BASE_ANIM_PTR_LO $0A
    .DEFINE BASE_ANIM_PTR_HI $0C
    .DEFINE ANIM_PTR_LO_CPY $19
    .DEFINE ANIM_PTR_HI_CPY $1B
    .DEFINE ANIMATION_ID $1D
    .DEFINE UNKNOWN_FLAGS $1F
	REP #PROC_FLAGS::ACCUM8 | PROC_FLAGS::INDEX8 | PROC_FLAGS::CARRY
	PHD
	PHA
	TDC
	ADC #$FFDF
	TCD
	PLA
	TXY
	STY UNKNOWN_FLAGS
	STA ANIMATION_ID
	LDA #$1400
	STA ANIM_PTR_LO
	LDA #$00D0
	STA ANIM_PTR_HI
	LDA ANIMATION_ID
	STA ANIMATION_ENTRY_POSITION
	ASL
	ADC ANIMATION_ENTRY_POSITION
	ASL
	ASL
	CLC
	ADC ANIM_PTR_LO
	STA ANIM_PTR_LO
	STA ANIM_PTR_LO_CPY
	LDA ANIM_PTR_HI
	STA ANIM_PTR_HI_CPY
	LDA ANIM_PTR_LO
	STA BASE_ANIM_PTR_LO
	LDA ANIM_PTR_HI
	STA BASE_ANIM_PTR_HI
	LDA [BASE_ANIM_PTR_LO]
	AND #$00FF
	STA ANIM_SPEED
	CMP #$00FF
	BNE @NOT_MAX_DURATION
	LDA #$0384
	STA ANIM_SPEED
@NOT_MAX_DURATION:
	SEP #PROC_FLAGS::ACCUM8
	LDY #$0004
	LDA [ANIM_PTR_LO],Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	ASL
	ASL
	TAX
	LDY #$0005
	LDA [ANIM_PTR_LO],Y
	JSL UNKNOWN_C42631
	LDY UNKNOWN_FLAGS
	CPY #$0001
	BEQ @PLAY_ANIMATION
	JMP a:.LOWORD(@UNKNOWN10)
@PLAY_ANIMATION:
	JSL UNKNOWN_C0943C
	LDA #$0002
	JSL UNKNOWN_C0DD2C
	SEP #PROC_FLAGS::ACCUM8
	LDY #$0001
	LDA [ANIM_PTR_LO],Y
	STA $18
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BEQ @UNKNOWN2
	SEP #PROC_FLAGS::ACCUM8
	LDY #$0002
	LDA [ANIM_PTR_LO],Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	TAX
	INX
	INX
	LDA $18
	AND #$00FF
	JSL UNKNOWN_C4A67E
@UNKNOWN2:
	LDA #$0200
	STA ANIM_PTR_LO
	PHB
	SEP #PROC_FLAGS::ACCUM8
	PLA
	STA ANIM_PTR_HI
	STZ $09
	REP #PROC_FLAGS::ACCUM8
	LDA ANIM_PTR_LO
	STA $12
	LDA ANIM_PTR_HI
	STA $14
	LDA #$007E
	STA $14
	LDA $12
	STA ANIM_PTR_LO
	LDA $14
	STA ANIM_PTR_HI
	LDA ANIM_PTR_LO
	STA $0E
	LDA ANIM_PTR_HI
	STA $10
	LDA ANIM_PTR_LO_CPY
	STA ANIM_PTR_LO
	LDA ANIM_PTR_HI_CPY
	STA ANIM_PTR_HI
	SEP #PROC_FLAGS::ACCUM8
	LDY #$0003
	LDA [ANIM_PTR_LO],Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	JSL UNKNOWN_C4954C
	LDX #$FFFF
	LDA ANIM_SPEED
	JSL UNKNOWN_C496E7
	LDA #$0000
	STA $16
	BRA @UNKNOWN5
@UNKNOWN3:
	LDA a:.LOWORD(UNKNOWN_7E002F)+1
	AND #$00FF
	BEQ @UNKNOWN4
	JSL READ_JOYPAD
@UNKNOWN4:
	JSL UNKNOWN_C426ED
	JSL OAM_CLEAR
	JSL UNKNOWN_C4268A
	JSL UNKNOWN_C426C7
	JSL UNKNOWN_C09466
	JSL UNKNOWN_C08B19_ENTRY_POINT_2
	JSL UNKNOWN_C4A7B0
	JSL READ_JOYPAD
	LDA $16
	INC
	STA $16
@UNKNOWN5:
	CMP ANIM_SPEED
	BCC @UNKNOWN3
	SEP #PROC_FLAGS::ACCUM8
	LDY #$0003
	LDA [ANIM_PTR_LO],Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	STA ANIM_SPEED
	LDA #$0032
	CLC
	SBC ANIM_SPEED
	BVC @UNKNOWN6
	BPL @UNKNOWN8
	BRA @UNKNOWN7
@UNKNOWN6:
	BMI @UNKNOWN8
@UNKNOWN7:
	JSL UNKNOWN_C08726
	BRA @UNKNOWN9
@UNKNOWN8:
	SEP #PROC_FLAGS::ACCUM8
	LDA #$00FF
	STA $0E
	LDX #$0200
	REP #PROC_FLAGS::ACCUM8
	LDA #$0200
	JSL MEMSET16
	LDA #$0018
	JSL UNKNOWN_C0856B
	JSL READ_JOYPAD
	LDA #$0001
	STA .LOWORD(UNKNOWN_7E4676)
@UNKNOWN9:
	JSL UNKNOWN_C09451
	JMP a:.LOWORD(@UNKNOWN22)
@UNKNOWN10:
	LDX #$0000
	SEP #PROC_FLAGS::ACCUM8
	LDY #$0003
	LDA [ANIM_PTR_LO],Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	STA ANIM_SPEED
	LDA #$0032
	CLC
	SBC ANIM_SPEED
	BVC @UNKNOWN11
	BPL @UNKNOWN13
	BRA @UNKNOWN12
@UNKNOWN11:
	BMI @UNKNOWN13
@UNKNOWN12:
	LDX #$0001
@UNKNOWN13:
	TXY
	STY ANIMATION_ID
	BEQ @UNKNOWN14
	LDX #$0001
	TXA
	JSL UNKNOWN_C0886C
	BRA @UNKNOWN15
@UNKNOWN14:
	LDX #$FFFF
	SEP #PROC_FLAGS::ACCUM8
	LDY #$0008
	LDA [ANIM_PTR_LO],Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	JSL UNKNOWN_C496E7
@UNKNOWN15:
	SEP #PROC_FLAGS::ACCUM8
	LDY #$0009
	LDA [ANIM_PTR_LO],Y
	STA $18
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BEQ @UNKNOWN16
	SEP #PROC_FLAGS::ACCUM8
	LDY #$000A
	LDA [ANIM_PTR_LO],Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	TAX
	LDA $18
	AND #$00FF
	JSL UNKNOWN_C4A67E
@UNKNOWN16:
	LDA #$0000
	STA $16
	BRA @UNKNOWN21
@UNKNOWN17:
	LDY ANIMATION_ID
	BNE @UNKNOWN19
	LDA a:.LOWORD(UNKNOWN_7E002F)+1
	AND #$00FF
	BEQ @UNKNOWN18
	JSL READ_JOYPAD
@UNKNOWN18:
	JSL UNKNOWN_C426ED
@UNKNOWN19:
	JSL OAM_CLEAR
	JSL UNKNOWN_C09466
	JSL UNKNOWN_C4A7B0
	JSL UNKNOWN_C08B19_ENTRY_POINT_2
	JSL READ_JOYPAD
	LDA $16
	CMP #$0001
	BNE @UNKNOWN20
	JSL UNKNOWN_C0943C
@UNKNOWN20:
	LDA $16
	INC
	STA $16
@UNKNOWN21:
	SEP #PROC_FLAGS::ACCUM8
	LDY #$0008
	LDA [ANIM_PTR_LO],Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	STA ANIM_SPEED
	LDA $16
	CMP ANIM_SPEED
	BCC @UNKNOWN17
	LDY ANIMATION_ID
	BNE @UNKNOWN22
	JSL UNKNOWN_C49740
@UNKNOWN22:
	LDA .LOWORD(GIYGAS_PHASE)
	CMP #$0004
	BCS @UNKNOWN23
	JSL UNKNOWN_C2EAAA
@UNKNOWN23:
	JSL UNKNOWN_C09451
	STZ .LOWORD(UNKNOWN_7E5DAA)
	STZ .LOWORD(UNKNOWN_7E5DA8)
	PLD
	RTL
